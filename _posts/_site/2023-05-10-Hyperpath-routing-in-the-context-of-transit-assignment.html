<p>How do transit passengers choose their routes in a complex network of lines and services? How can we estimate the distribution of passenger flows and the performance of transit systems? These are some of the questions that transit assignment models aim to answer. Transit assignment models are mathematical tools that predict how passengers behave and travel in a transit network, given some assumptions and inputs.</p>

<p>One of the basic concepts in transit assignment models is hyperpath routing. Hyperpath routing is a way of representing the set of optimal routes that a passenger can take from an origin to a destination, based on some criterion such as travel time or generalized cost. A hyperpath is a collection of links that form a subgraph of the transit network. Each link in the hyperpath also has a probability of being used by the passenger, which reflects the attractiveness and uncertainty of the route choice. The shortest hyperpath is optimal regarding the combination of paths weighted by the probability of being used.</p>

<p>Hyperpath routing can be applied to different types of transit assignment models, but in this following posts we will focus on frequency-based models. Frequency-based models assume that passengers do not have reliable information about the service schedules and arrival times, and they choose their routes based on the expected travel time or cost. This type of model is suitable for transit systems with rather frequent services.</p>

<p>To illustrate how hyperpath routing works in frequency-based models, we will use a classic algorithm by Spiess &amp; Florian [1], which has been implemented as an experimental feature in the  <a href="http://www.aequilibrae.com/python/latest/">aequilibrae</a> package. Aequilibrae is a comprehensive Python package for transportation modeling that offers various functionalities and features.</p>

<p>We will use a simple grid network as an example to demonstrate how a hyperpath depends on link frequency for a given origin-destination pair. Note that it can be extended to other contexts such as risk-averse vehicle navigation [2].</p>

<p>Let’s start by importing some Python packages.</p>

<h2 id="imports">Imports</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">networkx</span> <span class="k">as</span> <span class="n">nx</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="n">aequilibrae.paths.public_transport</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">HyperpathGenerating</span><span class="p">,</span>  <span class="c1"># feature_PuT_assignment branch
</span><span class="p">)</span>
<span class="kn">from</span> <span class="n">numba</span> <span class="kn">import</span> <span class="n">jit</span>

<span class="n">RS</span> <span class="o">=</span> <span class="mi">124</span>  <span class="c1"># random seed
</span><span class="n">FS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># figure size
</span></code></pre></div></div>

<p>System information and package versions:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>OS : Linux mint 21.1, based on Ubuntu 22.04
Python : 3.10.8 | packaged by conda-forge | (main, Nov 22 2022, 08:26:04) [GCC 10.4.0]
matplotlib : 3.6.3
networkx : 3.1
numpy : 1.23.5
pandas : 1.5.3
numba : 0.56.4
aequilibrae : dev version based on 0.9.0
</code></pre></div></div>

<h2 id="bells-network">Bell’s network</h2>

<p>We start by defining the directed graph $\mathcal{G} = \left( V, E \right) $, where $V$ and $E$ are the graph vertices and edges. The hyperpath generating algorithm requires 2 attributes for each edge $a \in V$:</p>
<ul>
  <li>edge travel time $u_a \geq 0$</li>
  <li>edge frequency $f_a \geq 0$</li>
</ul>

<p>The edge frequency is inversely related to the exposure to delay. For example, in a transit network, a boarding edge has a frequency that is the inverse of the headway (or half the headway, depending on the model assumptions). A walking edge has no exposure to delay, so its frequency is assumed to be infinite.</p>

<p>Bell’s network is a synthetic network: it is a $n$-by-$n$ grid bi-directional network [2, 3]. The edge travel time is taken as random number following a uniform distribution:</p>

\[u_a \sim \mathbf{U}[0,1)\]

<p>To demonstrate how the hyperpath depends on the exposure to delay, we will use a positive constant $\alpha$ and a <em>base delay</em> $d_a$ for each edge that follows a uniform distribution:</p>

\[d_a \sim \mathbf{U}[0,1)\]

<p>The constant $\alpha \geq 0$ allows us to adjust the edge frequency as follows:</p>

\[f_a = \left\{
\begin{array}{ll}
1 / \left( \alpha \; d_a \right) &amp; \text{if $\alpha \; d_a \neq 0$} \\ 
\infty &amp; \text{otherwise} \\
\end{array} 
\right.\]

<p>A smaller $\alpha$ value implies higher edge frequencies, and vice versa. Next, we will create the network as a pandas dataframe.</p>

<h3 id="vertices">Vertices</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_vertices</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">xv</span><span class="p">,</span> <span class="n">yv</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="sh">"</span><span class="s">xy</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">vertices</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">()</span>
    <span class="n">vertices</span><span class="p">[</span><span class="sh">"</span><span class="s">x</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">xv</span><span class="p">.</span><span class="nf">ravel</span><span class="p">()</span>
    <span class="n">vertices</span><span class="p">[</span><span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">yv</span><span class="p">.</span><span class="nf">ravel</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">vertices</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="nf">create_vertices</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">vertices</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.111111</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.222222</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="edges">Edges</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">create_edges_numba</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">tail</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint32</span><span class="p">)</span>
    <span class="n">head</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint32</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">tail</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">head</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">tail</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">head</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">tail</span><span class="p">,</span> <span class="n">head</span>


<span class="k">def</span> <span class="nf">create_edges</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">124</span><span class="p">):</span>
    <span class="n">tail</span><span class="p">,</span> <span class="n">head</span> <span class="o">=</span> <span class="nf">create_edges_numba</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">()</span>
    <span class="n">edges</span><span class="p">[</span><span class="sh">"</span><span class="s">tail</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">tail</span>
    <span class="n">edges</span><span class="p">[</span><span class="sh">"</span><span class="s">head</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">edges</span><span class="p">[</span><span class="sh">"</span><span class="s">trav_time</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">edges</span><span class="p">[</span><span class="sh">"</span><span class="s">delay_base</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">edges</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%%</span><span class="n">time</span>
<span class="n">edges</span> <span class="o">=</span> <span class="nf">create_edges</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">RS</span><span class="p">)</span>
<span class="n">edges</span><span class="p">.</span><span class="nf">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 230 ms, sys: 0 ns, total: 230 ms
Wall time: 230 ms
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tail</th>
      <th>head</th>
      <th>trav_time</th>
      <th>delay_base</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0.785253</td>
      <td>0.287917</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>10</td>
      <td>0.785859</td>
      <td>0.970429</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>11</td>
      <td>0.969136</td>
      <td>0.854512</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="plot-the-network">Plot the network</h3>

<p>We use the <a href="https://networkx.org/">NetworkX</a> package to plot the network. The bottom left vertex is the origin (‘o’) and the top right vertex is the destination (‘d’) for the hyperpath computation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># NetworkX
</span><span class="n">n_vertices</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[[</span><span class="sh">"</span><span class="s">x</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">]].</span><span class="n">values</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="nf">from_pandas_edgelist</span><span class="p">(</span>
    <span class="n">edges</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="sh">"</span><span class="s">tail</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="sh">"</span><span class="s">head</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">edge_attr</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">trav_time</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">delay_base</span><span class="sh">"</span><span class="p">],</span>
    <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="p">.</span><span class="n">DiGraph</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">widths</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FS</span><span class="p">)</span>
<span class="n">node_colors</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">]</span>
<span class="n">node_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
<span class="n">node_colors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
<span class="n">ns</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">node_size</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="n">ns</span><span class="p">]</span>
<span class="n">node_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
<span class="n">node_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
<span class="n">labeldict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">labeldict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">o</span><span class="sh">"</span>
<span class="n">labeldict</span><span class="p">[</span><span class="n">n</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">d</span><span class="sh">"</span>
<span class="n">nx</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span>
    <span class="n">G</span><span class="p">,</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">widths</span><span class="p">,</span>
    <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">,</span>
    <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span>
    <span class="n">arrowstyle</span><span class="o">=</span><span class="sh">"</span><span class="s">-&gt;</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labeldict</span><span class="p">,</span>
    <span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">gca</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Bell</span><span class="sh">'</span><span class="s">s network with $n$=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p align="center">
  <img width="800" src="/img/2023-05-10_01/output_13_0.png" alt="output_13_0" />
</p>

<p>We can also visualize the edge travel time:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">widths</span> <span class="o">=</span> <span class="mf">1e2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="sh">"</span><span class="s">trav_time</span><span class="sh">"</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">.</span><span class="nf">edges</span><span class="p">()])</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FS</span><span class="p">)</span>
<span class="n">node_colors</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">]</span>
<span class="n">node_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
<span class="n">node_colors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
<span class="n">ns</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">node_size</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="n">ns</span><span class="p">]</span>
<span class="n">node_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
<span class="n">node_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
<span class="n">labeldict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">labeldict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">o</span><span class="sh">"</span>
<span class="n">labeldict</span><span class="p">[</span><span class="n">n</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">d</span><span class="sh">"</span>
<span class="n">nx</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span>
    <span class="n">G</span><span class="p">,</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">widths</span><span class="p">,</span>
    <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">,</span>
    <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span>
    <span class="n">arrowstyle</span><span class="o">=</span><span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labeldict</span><span class="p">,</span>
    <span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">gca</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span>
    <span class="sh">"</span><span class="s">Bell</span><span class="sh">'</span><span class="s">s network - edge travel time :  $</span><span class="se">\\</span><span class="s">textit{trav_time}$</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span>
<span class="p">)</span>
</code></pre></div></div>

<p align="center">
  <img width="800" src="/img/2023-05-10_01/output_15_0.png" alt="output_15_0" />
</p>

<p>And the base delay:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">widths</span> <span class="o">=</span> <span class="mf">1e2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="sh">"</span><span class="s">delay_base</span><span class="sh">"</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">.</span><span class="nf">edges</span><span class="p">()])</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FS</span><span class="p">)</span>
<span class="n">node_colors</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">]</span>
<span class="n">node_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
<span class="n">node_colors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
<span class="n">ns</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">node_size</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="n">ns</span><span class="p">]</span>
<span class="n">node_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
<span class="n">node_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
<span class="n">labeldict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">labeldict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">o</span><span class="sh">"</span>
<span class="n">labeldict</span><span class="p">[</span><span class="n">n</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">d</span><span class="sh">"</span>
<span class="n">nx</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span>
    <span class="n">G</span><span class="p">,</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">widths</span><span class="p">,</span>
    <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">,</span>
    <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span>
    <span class="n">arrowstyle</span><span class="o">=</span><span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labeldict</span><span class="p">,</span>
    <span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">gca</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">"</span><span class="s">Bell</span><span class="sh">'</span><span class="s">s network - edge base delay : $</span><span class="se">\\</span><span class="s">textit{delay_base}$</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p align="center">
  <img width="800" src="/img/2023-05-10_01/output_17_0.png" alt="output_17_0" />
</p>

<h2 id="hyperpath-computation">Hyperpath computation</h2>

<p>We now introduce a function <code class="language-plaintext highlighter-rouge">plot_shortest_hyperpath</code> that:</p>
<ul>
  <li>creates the network,</li>
  <li>computes the edge frequency given an input value for $\alpha$,</li>
  <li>compute the shortest hyperpath,</li>
  <li>plot the network and hyperpath with NetworkX.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_shortest_hyperpath</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">FS</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">RS</span><span class="p">):</span>

    <span class="c1"># network creation
</span>    <span class="n">vertices</span> <span class="o">=</span> <span class="nf">create_vertices</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">n_vertices</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">edges</span> <span class="o">=</span> <span class="nf">create_edges</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">delay_base</span> <span class="o">=</span> <span class="n">edges</span><span class="p">.</span><span class="n">delay_base</span><span class="p">.</span><span class="n">values</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">delay_base</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">delay_base</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">freq_base</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">delay_base</span>
    <span class="n">freq_base</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span>
    <span class="n">edges</span><span class="p">[</span><span class="sh">"</span><span class="s">freq_base</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq_base</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">edges</span><span class="p">[</span><span class="sh">"</span><span class="s">freq</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">edges</span><span class="p">[</span><span class="sh">"</span><span class="s">freq</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">edges</span><span class="p">.</span><span class="n">freq_base</span> <span class="o">/</span> <span class="n">alpha</span>

    <span class="c1"># Spiess &amp; Florian
</span>    <span class="n">sf</span> <span class="o">=</span> <span class="nc">HyperpathGenerating</span><span class="p">(</span>
        <span class="n">edges</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="sh">"</span><span class="s">tail</span><span class="sh">"</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="sh">"</span><span class="s">head</span><span class="sh">"</span><span class="p">,</span> <span class="n">trav_time</span><span class="o">=</span><span class="sh">"</span><span class="s">trav_time</span><span class="sh">"</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="sh">"</span><span class="s">freq</span><span class="sh">"</span>
    <span class="p">)</span>
    <span class="n">sf</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">n</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># NetworkX
</span>    <span class="n">pos</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[[</span><span class="sh">"</span><span class="s">x</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">]].</span><span class="n">values</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="nf">from_pandas_edgelist</span><span class="p">(</span>
        <span class="n">sf</span><span class="p">.</span><span class="n">_edges</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="sh">"</span><span class="s">tail</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">target</span><span class="o">=</span><span class="sh">"</span><span class="s">head</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">edge_attr</span><span class="o">=</span><span class="sh">"</span><span class="s">volume</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="p">.</span><span class="n">DiGraph</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">widths</span> <span class="o">=</span> <span class="mf">1e2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="sh">"</span><span class="s">volume</span><span class="sh">"</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">.</span><span class="nf">edges</span><span class="p">()])</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">node_colors</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">]</span>
    <span class="n">node_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
    <span class="n">node_colors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">n</span>
    <span class="n">node_size</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="n">ns</span><span class="p">]</span>
    <span class="n">node_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
    <span class="n">node_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
    <span class="n">labeldict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">labeldict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">o</span><span class="sh">"</span>
    <span class="n">labeldict</span><span class="p">[</span><span class="n">n</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">d</span><span class="sh">"</span>
    <span class="n">nx</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span>
        <span class="n">G</span><span class="p">,</span>
        <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="n">widths</span><span class="p">,</span>
        <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">,</span>
        <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span>
        <span class="n">arrowstyle</span><span class="o">=</span><span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labeldict</span><span class="p">,</span>
        <span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">gca</span><span class="p">()</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">Shortest hyperpath - Bell</span><span class="sh">'</span><span class="s">s network $</span><span class="se">\\</span><span class="s">alpha$=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span>
    <span class="p">)</span>
</code></pre></div></div>

<p>We start with $\alpha=0$. This implies that there is no delay over all the network.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_shortest_hyperpath</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</code></pre></div></div>

<p align="center">
  <img width="800" src="/img/2023-05-10_01/output_21_0.png" alt="output_21_0" />
</p>

<p>The hyperpath that we obtain is the same as the shortest path that Dijkstra’s algorithm would have computed. We call NetworkX’s <code class="language-plaintext highlighter-rouge">dijkstra_path</code> method in order to compute the shortest path:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="nf">from_pandas_edgelist</span><span class="p">(</span>
    <span class="n">sf</span><span class="p">.</span><span class="n">_edges</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="sh">"</span><span class="s">tail</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="sh">"</span><span class="s">head</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">edge_attr</span><span class="o">=</span><span class="sh">"</span><span class="s">trav_time</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="p">.</span><span class="n">DiGraph</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Dijkstra
</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="nf">dijkstra_path</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="sh">'</span><span class="s">trav_time</span><span class="sh">'</span><span class="p">)</span>
<span class="n">edges</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">nx</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="nf">pairwise</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span>

<span class="c1"># plot
</span><span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FS</span><span class="p">)</span>
<span class="n">node_colors</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="sh">"</span><span class="s">gray</span><span class="sh">"</span><span class="p">]</span>
<span class="n">node_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
<span class="n">node_colors</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span>
<span class="n">ns</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">node_size</span> <span class="o">=</span> <span class="n">n_vertices</span> <span class="o">*</span> <span class="p">[</span><span class="n">ns</span><span class="p">]</span>
<span class="n">node_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
<span class="n">node_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">ns</span>
<span class="n">labeldict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">labeldict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">o</span><span class="sh">"</span>
<span class="n">labeldict</span><span class="p">[</span><span class="n">n</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">d</span><span class="sh">"</span>
<span class="n">widths</span> <span class="o">=</span> <span class="mf">1e2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span> <span class="nf">if </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">edges</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">.</span><span class="nf">edges</span><span class="p">()])</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[[</span><span class="sh">"</span><span class="s">x</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">]].</span><span class="n">values</span>
<span class="n">nx</span><span class="p">.</span><span class="nf">draw</span><span class="p">(</span>
    <span class="n">G</span><span class="p">,</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="n">widths</span><span class="p">,</span>
    <span class="n">node_size</span><span class="o">=</span><span class="n">node_size</span><span class="p">,</span>
    <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span>
    <span class="n">arrowstyle</span><span class="o">=</span><span class="sh">"</span><span class="s">-</span><span class="sh">"</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labeldict</span><span class="p">,</span>
    <span class="n">with_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">gca</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span>
    <span class="sa">f</span><span class="sh">"</span><span class="s">Shortest path - Bell</span><span class="sh">'</span><span class="s">s network</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">k</span><span class="sh">"</span>
<span class="p">)</span>
</code></pre></div></div>
<p align="center">
  <img width="800" src="/img/2023-05-10_01/output_24_0.png" alt="output_24_0" />
</p>

<p>Let’s introduce some delay by increasing the value of $\alpha$:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_shortest_hyperpath</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div></div>

<p align="center">
  <img width="800" src="/img/2023-05-10_01/output_23_0.png" alt="output_23_0" />
</p>

<p>The shortest path is no longer unique and multiple routes are suggested. The link usage probability is reflected by the line width. The majority of the flow still follows the shortest path, but some of it is distributed among different alternative paths. This becomes more apparent as we further increase $\alpha$:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_shortest_hyperpath</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</code></pre></div></div>

<p align="center">
  <img width="800" src="/img/2023-05-10_01/output_25_0.png" alt="output_25_0" />
</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">plot_shortest_hyperpath</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
</code></pre></div></div>

<p align="center">
  <img width="800" src="/img/2023-05-10_01/output_26_0.png" alt="output_26_0" />
</p>

<h2 id="references">References</h2>

<p>[1] Spiess, Heinz &amp; Florian, Michael, <em>Optimal strategies: A new assignment model for transit networks</em>, Transportation Research Part B: Methodological, Volume 23, Issue 2, 1989, Pages 83-102.</p>

<p>[2] Ma, Jiangshan &amp; Fukuda, Daisuke &amp; Schmöcker, Jan-Dirk. <em>Faster hyperpath generating algorithms for vehicle navigation</em>, Transportmetrica, Volume 149, 2012, Pages 1-24. 10.1080/18128602.2012.719165.</p>

<p>[3] Bell, Michael G.H., <em>Hyperstar: A multi-path Astar algorithm for risk averse vehicle navigation</em>, Transportation Research Part B: Methodological, Volume 43, Issue 1, 2009, Pages 97-107, ISSN 0191-2615,
https://doi.org/10.1016/j.trb.2008.05.010.</p>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://aetperf-github-io-1.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
